<?xml version='1.0'?>
<xefis-include>
	<modules>
		<module disabled='true' name='generic/fps'/>
		<module name='systems/state'>
			<property path='/settings/autopilot/enabled' type='boolean'>
				<default>false</default>
			</property>
			<property path='/config/hsi-nav/display-mode' type='integer'>
				<min>0</min>
				<max>1</max>
				<winding>true</winding>
			</property>
			<property path='/config/hsi-aux/range.kt' type='integer'>
				<min>2</min>
				<max>50</max>
			</property>
			<property path='/config/hsi-nav/range.kt' type='integer'>
				<min>2</min>
				<max>100</max>
			</property>
			<include name='xefis-x52pro.xml'/>
			<observe var='t5'>
				<if var='t5' equals='true'>
					<toggle path='/instrumentation/configuration/autopilot/control-stick/visible'/>
				</if>
			</observe>
			<observe var='t6'>
				<if var='t6' equals='true'>
					<toggle path='/instrumentation/configuration/autopilot/flight-director/visible'/>
				</if>
			</observe>
			<observe var='mode-2'>
				<choose>
					<when var='mode-2' equals='true'>
						<set path='/instrumentation/control/control-hint-visible' value='true'/>
						<set path='/instrumentation/control/control-hint' value='A/P'/>
					</when>
					<otherwise>
						<set path='/instrumentation/control/control-hint-visible' value='false'/>
					</otherwise>
				</choose>
			</observe>
			<observe var='function-up'>
				<if var='function-up' equals='true'>
					<choose>
						<when path='/config/hsi-aux/range.kt' less-or-equals='20'>
							<sub path='/config/hsi-aux/range.kt' value='2'/>
						</when>
						<when path='/config/hsi-aux/range.kt' less-or-equals='60'>
							<sub path='/config/hsi-aux/range.kt' value='10'/>
						</when>
						<when path='/config/hsi-aux/range.kt' less-or-equals='100'>
							<sub path='/config/hsi-aux/range.kt' value='20'/>
						</when>
						<otherwise>
							<sub path='/config/hsi-aux/range.kt' value='50'/>
						</otherwise>
					</choose>
				</if>
			</observe>
			<observe var='function-down'>
				<if var='function-down' equals='true'>
					<choose>
						<when path='/config/hsi-aux/range.kt' less-than='20'>
							<add path='/config/hsi-aux/range.kt' value='2'/>
						</when>
						<when path='/config/hsi-aux/range.kt' less-than='60'>
							<add path='/config/hsi-aux/range.kt' value='10'/>
						</when>
						<when path='/config/hsi-aux/range.kt' less-than='100'>
							<add path='/config/hsi-aux/range.kt' value='20'/>
						</when>
						<otherwise>
							<add path='/config/hsi-aux/range.kt' value='50'/>
						</otherwise>
					</choose>
				</if>
			</observe>
			<observe var='mfdselect-up'>
				<if var='mfdselect-up' equals='true'>
					<choose>
						<when path='/config/hsi-nav/range.kt' less-or-equals='20'>
							<sub path='/config/hsi-nav/range.kt' value='2'/>
						</when>
						<when path='/config/hsi-nav/range.kt' less-or-equals='60'>
							<sub path='/config/hsi-nav/range.kt' value='10'/>
						</when>
						<when path='/config/hsi-nav/range.kt' less-or-equals='100'>
							<sub path='/config/hsi-nav/range.kt' value='20'/>
						</when>
						<otherwise>
							<sub path='/config/hsi-nav/range.kt' value='50'/>
						</otherwise>
					</choose>
				</if>
			</observe>
			<observe var='mfdselect-down'>
				<if var='mfdselect-down' equals='true'>
					<choose>
						<when path='/config/hsi-nav/range.kt' less-than='20'>
							<add path='/config/hsi-nav/range.kt' value='2'/>
						</when>
						<when path='/config/hsi-nav/range.kt' less-than='60'>
							<add path='/config/hsi-nav/range.kt' value='10'/>
						</when>
						<when path='/config/hsi-nav/range.kt' less-than='100'>
							<add path='/config/hsi-nav/range.kt' value='20'/>
						</when>
						<otherwise>
							<add path='/config/hsi-nav/range.kt' value='50'/>
						</otherwise>
					</choose>
				</if>
			</observe>
			<observe var='mfdstartstop'>
				<if var='mfdstartstop' equals='true'>
					<sub path='/config/hsi-nav/display-mode' value='1'/>
				</if>
			</observe>
			<observe var='mfdreset'>
				<if var='mfdreset' equals='true'>
					<add path='/config/hsi-nav/display-mode' value='1'/>
				</if>
			</observe>
		</module>
		<module name='systems/lookahead'>
			<input>/instrumentation/altitude/amsl.ft</input>
			<output>/instrumentation/altitude/amsl-lookahead.ft</output>
			<smoothing>500</smoothing>
			<minimum-integration-time>0.01</minimum-integration-time>
			<properties>
				<property name='lookahead-time' path='/instrumentation/altitude/amsl-lookahead-time.s' default='10'/>
			</properties>
		</module>
		<module name='systems/ap'>
			<properties path='/fbw/ap'>
				<property name='ap-enabled' path='//input/main/button/28'/>
				<property name='bank-limit' path='/config/bank-limit.deg' default='15'/>
				<property name='yank-limit' path='/config/yank-limit.deg' default='7'/>
				<property name='selected-mag-heading' path='//instrumentation/autopilot/settings/heading.deg'/>
				<property name='selected-altitude' path='//instrumentation/autopilot/settings/altitude.ft'/>
				<property name='selected-climb-rate' path='//instrumentation/autopilot/settings/cbr.fpm'/>
				<property name='vertical-mode' path='/vertical-mode' default='0'/>
				<property name='measured-mag-heading' path='//instrumentation/orientation/heading-magnetic.deg'/>
				<property name='measured-altitude' path='//instrumentation/altitude/amsl.ft'/>
				<property name='measured-climb-rate' path='//instrumentation/altitude/climb-rate.fpm'/>
				<property name='measured-pitch' path='//instrumentation/orientation/pitch.deg'/>
				<property name='measured-roll' path='//instrumentation/orientation/roll.deg'/>
				<property name='input-pitch-axis' path='//input/main/axis/1'/>
				<property name='input-roll-axis' path='//input/main/axis/0'/>
				<property name='pitch-axis-dead-zone' path='//input/main/dead-zone/1' default='0.05'/>
				<property name='roll-axis-dead-zone' path='//input/main/dead-zone/0' default='0.05'/>
				<property name='max-pitch-angle' path='/max-pitch-angle.deg' default='15'/>
				<property name='max-roll-angle' path='/max-roll-angle.deg' default='25'/>
				<property name='output-control-stick-pitch' path='/control-stick/pitch.deg'/>
				<property name='output-control-stick-roll' path='/control-stick/roll.deg'/>
				<property name='output-pitch' path='/pitch.deg'/>
				<property name='output-roll' path='/roll.deg'/>
			</properties>
		</module>
		<module name='systems/stabilizer'>
			<properties path='/fbw/stabilizer'>
				<property name='stabilization-gain' path='/config/gain' default='1.0'/>
				<property name='pitch-gain' path='/config/pitch/gain' default='1.0'/>
				<property name='pitch-p' path='/config/pitch/p' default='10.0'/>
				<property name='pitch-i' path='/config/pitch/i' default='1.5'/>
				<property name='pitch-d' path='/config/pitch/d' default='0.5'/>
				<property name='pitch-error-power' path='/config/pitch/error-power' default='1.0'/>
				<property name='roll-gain' path='/config/roll/gain' default='1.0'/>
				<property name='roll-p' path='/config/roll/p' default='10.0'/>
				<property name='roll-i' path='/config/roll/i' default='1.5'/>
				<property name='roll-d' path='/config/roll/d' default='0.5'/>
				<property name='roll-error-power' path='/config/roll/error-power' default='1.0'/>
				<property name='yaw-gain' path='/config/yaw/gain' default='0.1'/>
				<property name='yaw-p' path='/config/yaw/p' default='0.1'/>
				<property name='yaw-i' path='/config/yaw/i' default='0.05'/>
				<property name='yaw-d' path='/config/yaw/d' default='0.01'/>
				<property name='yaw-error-power' path='/config/yaw/error-power' default='0.5'/>
				<property name='input-pitch' path='//fbw/ap/pitch.deg' default='0'/>
				<property name='input-roll' path='//fbw/ap/roll.deg' default='0'/>
				<property name='input-yaw-axis' path='//input/rudder/axis/2'/>
				<property name='measured-pitch' path='//instrumentation/orientation/pitch.deg'/>
				<property name='measured-roll' path='//instrumentation/orientation/roll.deg'/>
				<property name='measured-slip-skid' path='//instrumentation/slip-skid/slip-skid.g'/>
				<property name='elevator-minimum' path='/config/elevator/minimum' default='-0.75'/>
				<property name='elevator-maximum' path='/config/elevator/maximum' default='+0.75'/>
				<property name='ailerons-minimum' path='/config/ailerons/minimum' default='-0.5'/>
				<property name='ailerons-maximum' path='/config/ailerons/maximum' default='+0.5'/>
				<property name='rudder-minimum' path='/config/rudder/minimum' default='-1.0'/>
				<property name='rudder-maximum' path='/config/rudder/maximum' default='+1.0'/>
				<property name='output-elevator' path='//controls/elevator' default='0'/>
				<property name='output-ailerons' path='//controls/ailerons' default='0'/>
				<property name='output-rudder' path='//controls/rudder' default='0'/>
			</properties>
		</module>
	</modules>
</xefis-include>

